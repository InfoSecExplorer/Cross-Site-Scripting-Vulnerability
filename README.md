# What is cross-site scripting (XSS)?

Cross-site scripting (also known as XSS) is a web security vulnerability that allows an attacker to compromise the interactions that users have with a vulnerable application. It allows an attacker to circumvent the same origin policy, which is designed to segregate different websites from each other. Cross-site scripting vulnerabilities normally allow an attacker to masquerade as a victim user, to carry out any actions that the user is able to perform, and to access any of the user's data. If the victim user has privileged access within the application, then the attacker might be able to gain full control over all of the application's functionality and data. 

# How does XSS work?

Cross-site scripting works by manipulating a vulnerable web site so that it returns malicious JavaScript to users. When the malicious code executes inside a victim's browser, the attacker can fully compromise their interaction with the application. 

# What is the same-origin policy?

The same-origin policy is a web browser security mechanism that aims to prevent websites from attacking each other.

* The same-origin policy restricts scripts on one origin from accessing data from another origin. An origin consists of a URI scheme, domain and port number. For example, consider the following URL:
**http://normal-website.com/example/example.html**

This uses the scheme http, the domain normal-website.com, and the port number 80. The following table shows how the same-origin policy will be applied if content at the above URL tries to access other origins: 

# Why is the same-origin policy necessary?

When a browser sends an HTTP request from one origin to another, any cookies, including authentication session cookies, relevant to the other domain are also sent as part of the request. This means that the response will be generated within the user's session, and include any relevant data that is specific to the user. Without the same-origin policy, if you visited a malicious website, it would be able to read your emails from GMail, private messages from Facebook, etc. 

# What is CSP (content security policy)?

CSP is a browser security mechanism that aims to mitigate XSS and some other attacks. It works by restricting the resources (such as scripts and images) that a page can load and restricting whether a page can be framed by other pages. To enable CSP, a response needs to include an HTTP response header called Content-Security-Policy with a value containing the policy. The policy itself consists of one or more directives, separated by semicolons. 

# What are the types of XSS attacks?

**There are three main types of XSS attacks. These are:**

1. Reflected XSS, where the malicious script comes from the current HTTP request.
2. Stored XSS, where the malicious script comes from the website's database.
3. DOM-based XSS, where the vulnerability exists in client-side code rather than server-side code.


# 1. Reflected XSS into HTML context with nothing encoded

**How To Hunt:**

1. Test every entry point on the website.
2. Submit random alphanumeric values and analyze the response to determine whether they are reflected or not.
3. Copy and paste the following code into the input functionality: <script>alert(1)</script>.
4. which will trigger a visible popup within the browser if the attack succeeds. 

# 2. Reflected XSS into attribute with angle brackets HTML-encoded

**How To Hunt:**

1. Test every entry point on the website.
2. Submit a random alphanumeric string in the input point.
3. Observe that the random string has been reflected inside a quoted attribute.
4. Replace your input with the following payload to escape the quoted attribute and inject an event handler: "onmouseover="alert(1)
5. which will trigger a visible popup within the browser if the attack succeeds.

# 3. Reflected XSS into a JavaScript string with angle brackets HTML encoded

**How To Hunt:**

1. Test every entry point on the website.
2. Submit a random alphanumeric string in the input point.
3. Observe that the random string has been reflected inside a JavaScript string.
4. Replace your input with the following payload to break out of the JavaScript string and inject an alert: '-alert(1)-'.
5. which will trigger a visible popup within the browser if the attack succeeds.

# 4. Reflected XSS into HTML context with most tags and attributes blocked

**How To Hunt:**

1. Test every entry point on the website.
2. Inject payloads in entry point <script>alert(1)</script>.
3. Observe that this gets blocked. In the next few steps, we'll use Burp Intruder to test which tags and attributes are being blocked.
4. The web application uses a firewall (WAF) to protect against common XSS vectors.
5. Use Burp Suite Intruder to identify which tags and attributes are not blocked.
6. Use these tags and attributes to create XSS payloads and inject them into entry points.
7. This will trigger a visible popup within the browser if the attack succeeds.
8. Refferance - https://portswigger.net/web-security/cross-site-scripting/contexts/lab-html-context-with-most-tags-and-attributes-blocked

# 5. Reflected XSS into a JavaScript string with single quote and backslash escaped

**How To Hunt:**

1. Test every entry point on the website.
2. Submit a random alphanumeric string in the input point.
3. Observe that the random string has been reflected inside a JavaScript string.
4. Try sending the payload test'payload and observe that your single quote gets backslash-escaped, preventing you from breaking out of the string.
5. Replace your input with the following payload to break out of the script block and inject a new script: </script><script>alert(1)</script>.
6. This will trigger a visible popup within the browser if the attack succeeds.





















